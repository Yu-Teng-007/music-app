# 🎵 音乐应用项目概览

**项目名称**: Music App  
**版本**: v1.0  
**创建日期**: 2025-06-27  
**项目类型**: 全栈音乐流媒体应用

---

## 📋 项目简介

这是一个现代化的音乐流媒体应用，提供完整的音乐播放、管理和社交功能。项目采用前后端分离架构，使用最新的技术栈构建，具有高性能、高可用性和良好的用户体验。

### 🎯 核心功能

- **音乐播放**: 支持多种音频格式，提供高质量音频播放体验
- **用户管理**: 完整的用户注册、登录、个人资料管理系统
- **歌单管理**: 创建、编辑、分享个人歌单
- **音乐发现**: 智能推荐、分类浏览、搜索功能
- **社交功能**: 用户关注、动态分享、评论互动
- **离线下载**: 支持音乐离线下载和本地播放
- **实时通信**: WebSocket实时消息推送

---

## 🏗️ 技术架构

### 整体架构图

```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   前端 (Vue3)   │    │  后端 (NestJS)  │    │  数据库 (MySQL) │
│                 │    │                 │    │                 │
│ • Vue 3         │◄──►│ • NestJS        │◄──►│ • MySQL 8.0     │
│ • TypeScript    │    │ • TypeORM       │    │ • Redis (缓存)  │
│ • Vite          │    │ • JWT认证       │    │                 │
│ • Pinia         │    │ • WebSocket     │    │                 │
│ • Vue Router    │    │ • Swagger       │    │                 │
└─────────────────┘    └─────────────────┘    └─────────────────┘
```

### 🎨 前端技术栈

| 技术 | 版本 | 用途 |
|------|------|------|
| **Vue 3** | ^3.5.13 | 前端框架 |
| **TypeScript** | 最新 | 类型安全 |
| **Vite** | 最新 | 构建工具 |
| **Pinia** | ^3.0.1 | 状态管理 |
| **Vue Router** | ^4.5.0 | 路由管理 |
| **Axios** | ^1.10.0 | HTTP客户端 |
| **Socket.io** | ^4.8.1 | 实时通信 |
| **Lucide Vue** | ^0.522.0 | 图标库 |
| **Swiper** | ^11.2.8 | 轮播组件 |

### 🔧 后端技术栈

| 技术 | 版本 | 用途 |
|------|------|------|
| **NestJS** | ^10.0.0 | 后端框架 |
| **TypeScript** | 最新 | 类型安全 |
| **TypeORM** | ^0.3.20 | ORM框架 |
| **MySQL** | 8.0+ | 主数据库 |
| **Redis** | 最新 | 缓存/会话 |
| **JWT** | 最新 | 身份认证 |
| **Swagger** | 最新 | API文档 |
| **Socket.io** | 最新 | 实时通信 |
| **Multer** | 最新 | 文件上传 |

### 🗄️ 数据库设计

#### 核心实体表

| 表名 | 描述 | 主要字段 |
|------|------|----------|
| `users` | 用户信息 | id, phone, username, password, avatar |
| `songs` | 歌曲信息 | id, title, artist, album, duration, audioUrl |
| `playlists` | 歌单信息 | id, name, description, coverUrl, userId |
| `genres` | 音乐分类 | id, name, description, isActive |
| `favorites` | 收藏记录 | id, userId, songId, createdAt |
| `comments` | 评论系统 | id, content, userId, songId, createdAt |
| `history` | 播放历史 | id, userId, songId, playedAt, duration |

#### 社交功能表

| 表名 | 描述 | 主要字段 |
|------|------|----------|
| `user_follows` | 用户关注 | id, followerId, followingId |
| `user_feeds` | 用户动态 | id, userId, content, type, createdAt |
| `feed_likes` | 动态点赞 | id, userId, feedId |
| `feed_comments` | 动态评论 | id, userId, feedId, content |

#### 下载功能表

| 表名 | 描述 | 主要字段 |
|------|------|----------|
| `downloads` | 下载记录 | id, userId, songId, status, quality |
| `download_cache` | 下载缓存 | id, songId, filePath, fileSize |
| `user_storage` | 用户存储 | id, userId, totalSpace, usedSpace |

---

## 📁 项目结构

### 前端目录结构

```
music-app-frontend/
├── src/
│   ├── components/          # 可复用组件
│   │   ├── AudioPlayer.vue  # 音频播放器
│   │   ├── MiniPlayer.vue   # 迷你播放器
│   │   └── ...
│   ├── views/              # 页面组件
│   │   ├── HomeView.vue    # 首页
│   │   ├── PlayerView.vue  # 播放器页面
│   │   └── ...
│   ├── stores/             # Pinia状态管理
│   │   ├── auth.ts         # 认证状态
│   │   ├── music.ts        # 音乐播放状态
│   │   └── ...
│   ├── services/           # API服务
│   │   ├── auth-api.ts     # 认证API
│   │   ├── music-api.ts    # 音乐API
│   │   └── ...
│   ├── router/             # 路由配置
│   ├── utils/              # 工具函数
│   └── assets/             # 静态资源
├── public/                 # 公共资源
└── package.json           # 依赖配置
```

### 后端目录结构

```
music-app-backend/
├── src/
│   ├── auth/               # 认证授权模块
│   ├── users/              # 用户管理模块 ✨
│   │   └── preferences/    # 用户偏好设置
│   ├── media/              # 媒体处理模块 ✨
│   │   ├── upload/         # 文件上传功能
│   │   └── download/       # 文件下载功能
│   ├── songs/              # 歌曲数据模块
│   ├── playlists/          # 歌单管理模块
│   ├── favorites/          # 收藏管理模块
│   ├── genres/             # 音乐分类模块
│   ├── history/            # 播放历史模块
│   ├── search-history/     # 搜索历史模块
│   ├── social/             # 社交功能模块
│   ├── comments/           # 评论系统模块
│   ├── realtime/           # 实时通信模块
│   ├── sms/                # 短信服务模块
│   ├── entities/           # 数据库实体定义
│   ├── dto/                # 数据传输对象
│   ├── common/             # 公共模块
│   │   ├── cache/          # 缓存服务
│   │   ├── security/       # 安全防护
│   │   ├── throttler/      # 请求限流
│   │   ├── logger/         # 日志服务
│   │   └── filters/        # 异常过滤器
│   ├── config/             # 配置文件管理
│   ├── database/           # 数据库相关
│   └── static/             # 静态资源
├── uploads/                # 上传文件存储
├── downloads/              # 下载文件存储
├── logs/                   # 应用日志文件
└── package.json           # 项目依赖配置
```

---

## 🚀 核心功能模块

### 1. 认证授权模块 (`/auth`)
- **手机号验证码登录**: 支持短信验证码登录
- **用户名密码登录**: 传统用户名密码登录
- **JWT令牌认证**: 无状态身份验证
- **刷新令牌机制**: 自动续期访问令牌
- **密码重置**: 支持忘记密码重置
- **CSRF防护**: 跨站请求伪造防护

### 2. 用户管理模块 (`/users`) ✨
- **用户档案管理**: 个人信息维护
- **偏好设置**: 个性化用户偏好配置
- **隐私设置**: 用户隐私权限控制
- **账户安全**: 安全设置和验证

### 3. 媒体处理模块 (`/media`) ✨
- **文件上传**: 支持音乐文件、图片上传
- **文件下载**: 高质量音乐下载功能
- **格式转换**: 多种音频格式支持
- **存储管理**: 用户存储空间管理
- **下载队列**: 批量下载任务管理

### 4. 音乐数据模块 (`/songs`)
- **歌曲信息管理**: 歌曲元数据维护
- **多格式支持**: MP3、WAV、OGG、FLAC等
- **音质选择**: 不同音质版本管理
- **歌词同步**: 歌词显示和同步

### 5. 歌单管理模块 (`/playlists`)
- **创建歌单**: 用户可创建个人歌单
- **编辑歌单**: 修改歌单信息和封面
- **歌曲管理**: 添加、删除、排序歌单中的歌曲
- **分享功能**: 公开或私有歌单设置
- **推荐歌单**: 系统推荐热门歌单

### 6. 收藏管理模块 (`/favorites`)
- **收藏歌曲**: 收藏喜欢的歌曲
- **收藏歌单**: 收藏其他用户的歌单
- **收藏分类**: 按类型组织收藏内容
- **快速访问**: 便捷的收藏内容访问

### 7. 搜索和发现模块
- **智能搜索**: 支持歌曲、艺术家、专辑搜索 (`/songs/search`)
- **分类浏览**: 按音乐类型分类浏览 (`/genres`)
- **搜索历史**: 保存用户搜索记录 (`/search-history`)
- **播放历史**: 用户播放记录管理 (`/history`)

### 8. 社交功能模块 (`/social`)
- **用户关注**: 关注其他用户
- **动态分享**: 分享音乐和心情
- **评论系统**: 对歌曲和动态进行评论 (`/comments`)
- **点赞功能**: 点赞喜欢的内容
- **实时通信**: WebSocket实时消息推送 (`/realtime`)

### 9. 通信服务模块
- **短信服务**: 验证码发送和验证 (`/sms`)
- **实时通知**: 系统消息推送
- **邮件服务**: 邮件通知功能

---

## 🔒 安全特性

### 认证和授权
- **JWT令牌**: 无状态身份认证
- **刷新令牌**: 安全的令牌续期机制
- **CSRF防护**: 跨站请求伪造防护
- **请求限流**: 防止API滥用
- **输入验证**: 严格的数据验证

### 数据安全
- **密码加密**: BCrypt密码哈希
- **SQL注入防护**: TypeORM参数化查询
- **XSS防护**: 输入输出过滤
- **文件上传安全**: 文件类型和大小限制
- **HTTPS支持**: 传输层安全

---

## 📊 性能优化

### 前端优化
- **代码分割**: 按需加载减少初始包大小
- **图片懒加载**: 优化图片加载性能
- **缓存策略**: 合理的浏览器缓存配置
- **CDN加速**: 静态资源CDN分发
- **PWA支持**: 渐进式Web应用特性

### 后端优化
- **数据库索引**: 合理的数据库索引设计
- **查询优化**: 高效的数据库查询
- **缓存机制**: Redis缓存热点数据
- **连接池**: 数据库连接池优化
- **异步处理**: 非阻塞异步操作

---

## 🌐 部署架构

### 开发环境
- **前端**: Vite开发服务器 (端口5188)
- **后端**: NestJS开发服务器 (端口3000)
- **数据库**: 本地MySQL实例
- **缓存**: 本地Redis实例

### 生产环境
- **前端**: Nginx静态文件服务
- **后端**: PM2进程管理
- **数据库**: MySQL主从复制
- **缓存**: Redis集群
- **负载均衡**: Nginx反向代理

---

## 📈 项目统计

### 代码统计
- **前端页面**: 21个主要页面
- **后端模块**: 13个功能模块
- **数据库表**: 15个核心表
- **API接口**: 80+个RESTful接口
- **组件数量**: 50+个Vue组件

### 功能完成度
- **核心功能**: 100%完成
- **用户系统**: 100%完成
- **音乐播放**: 100%完成
- **社交功能**: 100%完成
- **离线下载**: 95%完成
- **管理后台**: 待开发

---

## 🔮 未来规划

### 短期目标 (1-3个月)
- [ ] 管理后台开发
- [ ] 移动端适配优化
- [ ] 性能监控系统
- [ ] 自动化测试覆盖

### 中期目标 (3-6个月)
- [ ] 音乐推荐算法优化
- [ ] 多语言国际化支持
- [ ] 第三方音乐平台集成
- [ ] 音乐可视化效果

### 长期目标 (6-12个月)
- [ ] 移动端原生应用
- [ ] 音乐创作工具
- [ ] 直播功能
- [ ] AI音乐生成

---

## 📞 联系信息

**项目维护者**: 开发团队  
**技术支持**: 通过GitHub Issues  
**文档更新**: 2025-06-27

---

*本文档将随着项目发展持续更新，请关注最新版本。*
