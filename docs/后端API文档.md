# ğŸ”Œ åç«¯APIæ–‡æ¡£

**APIç‰ˆæœ¬**: v1.0  
**åŸºç¡€URL**: `http://localhost:3000/api`  
**Swaggeræ–‡æ¡£**: `http://localhost:3000/api/docs`  
**æ›´æ–°æ—¥æœŸ**: 2025-06-27

---

## ğŸ“‹ APIæ¦‚è§ˆ

æœ¬æ–‡æ¡£æè¿°äº†éŸ³ä¹åº”ç”¨åç«¯APIçš„æ‰€æœ‰æ¥å£ï¼ŒåŒ…æ‹¬è®¤è¯ã€éŸ³ä¹ç®¡ç†ã€ç”¨æˆ·ç®¡ç†ã€ç¤¾äº¤åŠŸèƒ½ç­‰æ¨¡å—ã€‚

### ğŸ”‘ è®¤è¯æ–¹å¼

APIä½¿ç”¨JWT (JSON Web Token) è¿›è¡Œèº«ä»½è®¤è¯ï¼š

```http
Authorization: Bearer <your-jwt-token>
```

### ğŸ“Š å“åº”æ ¼å¼

æ‰€æœ‰APIå“åº”éƒ½éµå¾ªç»Ÿä¸€çš„æ ¼å¼ï¼š

```json
{
  "success": true,
  "data": {},
  "message": "æ“ä½œæˆåŠŸ",
  "timestamp": "2025-06-27T10:00:00.000Z"
}
```

### âŒ é”™è¯¯å“åº”

```json
{
  "success": false,
  "error": {
    "code": "ERROR_CODE",
    "message": "é”™è¯¯æè¿°",
    "details": {}
  },
  "timestamp": "2025-06-27T10:00:00.000Z"
}
```

---

## ğŸ“ APIæ¨¡å—ç»“æ„

æœ¬APIæŒ‰ç…§åŠŸèƒ½æ¨¡å—è¿›è¡Œç»„ç»‡ï¼Œæ¯ä¸ªæ¨¡å—è´Ÿè´£ç‰¹å®šçš„ä¸šåŠ¡åŠŸèƒ½ï¼š

| æ¨¡å— | è·¯å¾„å‰ç¼€ | æè¿° | ä¸»è¦åŠŸèƒ½ |
|------|----------|------|----------|
| ğŸ” **è®¤è¯æ¨¡å—** | `/auth` | ç”¨æˆ·è®¤è¯æˆæƒ | æ³¨å†Œã€ç™»å½•ã€JWTç®¡ç†ã€å¯†ç é‡ç½® |
| ğŸ‘¤ **ç”¨æˆ·æ¨¡å—** | `/users` | ç”¨æˆ·ç®¡ç† | ç”¨æˆ·æ¡£æ¡ˆã€åå¥½è®¾ç½®ã€éšç§æ§åˆ¶ |
| ğŸ“ **åª’ä½“æ¨¡å—** | `/upload`, `/download` | åª’ä½“å¤„ç† | æ–‡ä»¶ä¸Šä¼ ä¸‹è½½ã€æ ¼å¼è½¬æ¢ã€å­˜å‚¨ç®¡ç† |
| ğŸµ **æ­Œæ›²æ¨¡å—** | `/songs` | æ­Œæ›²æ•°æ® | æ­Œæ›²ä¿¡æ¯ã€æœç´¢ã€æ’­æ”¾ã€å…ƒæ•°æ® |
| ğŸ“‹ **æ­Œå•æ¨¡å—** | `/playlists` | æ­Œå•ç®¡ç† | åˆ›å»ºã€ç¼–è¾‘ã€åˆ†äº«æ­Œå• |
| â¤ï¸ **æ”¶è—æ¨¡å—** | `/favorites` | æ”¶è—ç®¡ç† | æ”¶è—æ­Œæ›²ã€æ­Œå•ã€åˆ†ç±»ç®¡ç† |
| ğŸ­ **åˆ†ç±»æ¨¡å—** | `/genres` | éŸ³ä¹åˆ†ç±» | éŸ³ä¹ç±»å‹ã€åˆ†ç±»æµè§ˆ |
| ğŸ“Š **å†å²æ¨¡å—** | `/history` | æ’­æ”¾å†å² | æ’­æ”¾è®°å½•ã€ç»Ÿè®¡åˆ†æ |
| ğŸ” **æœç´¢æ¨¡å—** | `/search-history` | æœç´¢å†å² | æœç´¢è®°å½•ã€çƒ­é—¨æœç´¢ |
| ğŸ‘¥ **ç¤¾äº¤æ¨¡å—** | `/social` | ç¤¾äº¤åŠŸèƒ½ | å…³æ³¨ã€åŠ¨æ€ã€äº’åŠ¨ |
| ğŸ’¬ **è¯„è®ºæ¨¡å—** | `/comments` | è¯„è®ºç³»ç»Ÿ | è¯„è®ºã€å›å¤ã€ç‚¹èµ |
| ğŸ”„ **å®æ—¶æ¨¡å—** | `/realtime` | å®æ—¶é€šä¿¡ | WebSocketã€æ¶ˆæ¯æ¨é€ |
| ğŸ“± **çŸ­ä¿¡æ¨¡å—** | `/sms` | çŸ­ä¿¡æœåŠ¡ | éªŒè¯ç å‘é€ã€çŸ­ä¿¡é€šçŸ¥ |

### ğŸ”— æ¨¡å—ä¾èµ–å…³ç³»

```mermaid
graph TD
    A[è®¤è¯æ¨¡å—] --> B[ç”¨æˆ·æ¨¡å—]
    B --> C[åª’ä½“æ¨¡å—]
    B --> D[æ­Œæ›²æ¨¡å—]
    B --> E[æ­Œå•æ¨¡å—]
    B --> F[æ”¶è—æ¨¡å—]
    D --> G[åˆ†ç±»æ¨¡å—]
    D --> H[å†å²æ¨¡å—]
    D --> I[æœç´¢æ¨¡å—]
    B --> J[ç¤¾äº¤æ¨¡å—]
    J --> K[è¯„è®ºæ¨¡å—]
    J --> L[å®æ—¶æ¨¡å—]
    A --> M[çŸ­ä¿¡æ¨¡å—]
```

---

## ğŸ” è®¤è¯æ¨¡å— (Auth)

### ç”¨æˆ·æ³¨å†Œ

**POST** `/auth/register`

æ³¨å†Œæ–°ç”¨æˆ·è´¦æˆ·ï¼Œæ”¯æŒæ‰‹æœºå·å’Œç”¨æˆ·åä¸¤ç§æ–¹å¼ã€‚

**è¯·æ±‚ä½“**:
```json
{
  "registerType": "phone", // "phone" | "username"
  "phone": "13800138000",
  "smsCode": "123456",
  "username": "testuser",
  "password": "password123",
  "confirmPassword": "password123"
}
```

**å“åº”**:
```json
{
  "success": true,
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "refreshToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "user": {
      "id": "uuid",
      "phone": "13800138000",
      "username": "testuser",
      "avatar": null,
      "isActive": true,
      "createdAt": "2025-06-27T10:00:00.000Z"
    }
  },
  "message": "æ³¨å†ŒæˆåŠŸ"
}
```

### ç”¨æˆ·ç™»å½•

**POST** `/auth/login`

ç”¨æˆ·ç™»å½•ï¼Œæ”¯æŒæ‰‹æœºå·éªŒè¯ç å’Œç”¨æˆ·åå¯†ç ä¸¤ç§æ–¹å¼ã€‚

**è¯·æ±‚ä½“**:
```json
{
  "loginType": "phone", // "phone" | "username"
  "phone": "13800138000",
  "smsCode": "123456",
  "username": "testuser",
  "password": "password123"
}
```

### è·å–ç”¨æˆ·æ¡£æ¡ˆ

**GET** `/auth/profile`

ğŸ”’ **éœ€è¦è®¤è¯**

è·å–å½“å‰ç”¨æˆ·çš„è¯¦ç»†æ¡£æ¡ˆä¿¡æ¯ã€‚

**å“åº”**:
```json
{
  "success": true,
  "data": {
    "id": "uuid",
    "phone": "13800138000",
    "username": "testuser",
    "avatar": "https://example.com/avatar.jpg",
    "isActive": true,
    "greeting": "æ—©ä¸Šå¥½",
    "subGreeting": "ä»Šå¤©æƒ³å¬ä»€ä¹ˆéŸ³ä¹å‘¢ï¼Ÿ",
    "createdAt": "2025-06-27T10:00:00.000Z",
    "updatedAt": "2025-06-27T10:00:00.000Z"
  }
}
```

### æ›´æ–°ç”¨æˆ·æ¡£æ¡ˆ

**PUT** `/auth/profile`

ğŸ”’ **éœ€è¦è®¤è¯**

æ›´æ–°ç”¨æˆ·æ¡£æ¡ˆä¿¡æ¯ã€‚

**è¯·æ±‚ä½“**:
```json
{
  "username": "newusername",
  "avatar": "https://example.com/new-avatar.jpg"
}
```

### ä¿®æ”¹å¯†ç 

**PUT** `/auth/change-password`

ğŸ”’ **éœ€è¦è®¤è¯**

ä¿®æ”¹ç”¨æˆ·å¯†ç ã€‚

**è¯·æ±‚ä½“**:
```json
{
  "currentPassword": "oldpassword",
  "newPassword": "newpassword",
  "confirmPassword": "newpassword"
}
```

### åˆ·æ–°ä»¤ç‰Œ

**POST** `/auth/refresh`

ä½¿ç”¨åˆ·æ–°ä»¤ç‰Œè·å–æ–°çš„è®¿é—®ä»¤ç‰Œã€‚

**è¯·æ±‚ä½“**:
```json
{
  "refreshToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}
```

### å‘é€çŸ­ä¿¡éªŒè¯ç 

**POST** `/auth/send-sms`

å‘é€çŸ­ä¿¡éªŒè¯ç åˆ°æŒ‡å®šæ‰‹æœºå·ã€‚

**è¯·æ±‚ä½“**:
```json
{
  "phone": "13800138000",
  "type": "login" // "login" | "register" | "reset"
}
```

---

## ğŸ‘¤ ç”¨æˆ·æ¨¡å— (Users)

### è·å–ç”¨æˆ·æ¡£æ¡ˆ

**GET** `/users/profile`

ğŸ”’ **éœ€è¦è®¤è¯**

è·å–å½“å‰ç”¨æˆ·çš„æ¡£æ¡ˆä¿¡æ¯ã€‚

**å“åº”**:
```json
{
  "success": true,
  "data": {
    "id": "uuid",
    "username": "testuser",
    "phone": "13800138000",
    "email": "user@example.com",
    "avatar": "https://example.com/avatar.jpg",
    "bio": "éŸ³ä¹çˆ±å¥½è€…",
    "isActive": true,
    "createdAt": "2025-06-27T10:00:00.000Z",
    "updatedAt": "2025-06-27T10:00:00.000Z"
  }
}
```

### æ›´æ–°ç”¨æˆ·æ¡£æ¡ˆ

**PUT** `/users/profile`

ğŸ”’ **éœ€è¦è®¤è¯**

æ›´æ–°ç”¨æˆ·æ¡£æ¡ˆä¿¡æ¯ã€‚

**è¯·æ±‚ä½“**:
```json
{
  "username": "newusername",
  "email": "newemail@example.com",
  "avatar": "https://example.com/new-avatar.jpg",
  "bio": "æ›´æ–°çš„ä¸ªäººç®€ä»‹"
}
```

### ç”¨æˆ·åå¥½è®¾ç½®

**GET** `/users/preferences`

ğŸ”’ **éœ€è¦è®¤è¯**

è·å–ç”¨æˆ·åå¥½è®¾ç½®ã€‚

**POST** `/users/preferences`

ğŸ”’ **éœ€è¦è®¤è¯**

æ›´æ–°ç”¨æˆ·åå¥½è®¾ç½®ã€‚

**è¯·æ±‚ä½“**:
```json
{
  "key": "theme",
  "value": "dark",
  "category": "appearance"
}
```

---

## ğŸ“ åª’ä½“æ¨¡å— (Media)

### æ–‡ä»¶ä¸Šä¼ 

**POST** `/upload`

ğŸ”’ **éœ€è¦è®¤è¯**

ä¸Šä¼ éŸ³ä¹æ–‡ä»¶æˆ–å›¾ç‰‡æ–‡ä»¶ã€‚

**è¯·æ±‚**: `multipart/form-data`
- `file`: æ–‡ä»¶ (å¿…éœ€)
- `type`: æ–‡ä»¶ç±»å‹ (`audio` | `image`)
- `category`: æ–‡ä»¶åˆ†ç±» (å¯é€‰)

**å“åº”**:
```json
{
  "success": true,
  "data": {
    "id": "uuid",
    "filename": "song.mp3",
    "originalName": "æˆ‘çš„æ­Œæ›².mp3",
    "mimeType": "audio/mpeg",
    "size": 5242880,
    "url": "https://example.com/uploads/song.mp3",
    "uploadedAt": "2025-06-27T10:00:00.000Z"
  }
}
```

### åˆ›å»ºä¸‹è½½ä»»åŠ¡

**POST** `/download`

ğŸ”’ **éœ€è¦è®¤è¯**

åˆ›å»ºéŸ³ä¹ä¸‹è½½ä»»åŠ¡ã€‚

**è¯·æ±‚ä½“**:
```json
{
  "songId": "uuid",
  "quality": "high" // "low" | "medium" | "high" | "lossless"
}
```

**å“åº”**:
```json
{
  "success": true,
  "data": {
    "id": "uuid",
    "songId": "uuid",
    "status": "pending",
    "progress": 0,
    "quality": "high",
    "estimatedSize": 5242880,
    "createdAt": "2025-06-27T10:00:00.000Z"
  }
}
```

### è·å–ä¸‹è½½åˆ—è¡¨

**GET** `/download`

ğŸ”’ **éœ€è¦è®¤è¯**

è·å–ç”¨æˆ·çš„ä¸‹è½½ä»»åŠ¡åˆ—è¡¨ã€‚

**æŸ¥è¯¢å‚æ•°**:
- `status`: ä¸‹è½½çŠ¶æ€ (`pending` | `downloading` | `completed` | `failed`)
- `page`: é¡µç  (é»˜è®¤: 1)
- `limit`: æ¯é¡µæ•°é‡ (é»˜è®¤: 20)

### ä¸‹è½½æ§åˆ¶

**PUT** `/download/{id}/pause`

ğŸ”’ **éœ€è¦è®¤è¯**

æš‚åœä¸‹è½½ä»»åŠ¡ã€‚

**PUT** `/download/{id}/resume`

ğŸ”’ **éœ€è¦è®¤è¯**

æ¢å¤ä¸‹è½½ä»»åŠ¡ã€‚

**PUT** `/download/{id}/retry`

ğŸ”’ **éœ€è¦è®¤è¯**

é‡è¯•å¤±è´¥çš„ä¸‹è½½ä»»åŠ¡ã€‚

---

## ğŸµ æ­Œæ›²æ¨¡å— (Songs)

### è·å–æ­Œæ›²åˆ—è¡¨

**GET** `/songs`

è·å–æ­Œæ›²åˆ—è¡¨ï¼Œæ”¯æŒåˆ†é¡µå’Œç­›é€‰ã€‚

**æŸ¥è¯¢å‚æ•°**:
- `page`: é¡µç  (é»˜è®¤: 1)
- `limit`: æ¯é¡µæ•°é‡ (é»˜è®¤: 20)
- `genre`: éŸ³ä¹ç±»å‹ç­›é€‰
- `artist`: è‰ºæœ¯å®¶ç­›é€‰
- `search`: æœç´¢å…³é”®è¯
- `sort`: æ’åºæ–¹å¼ (`latest`, `popular`, `title`)

**å“åº”**:
```json
{
  "success": true,
  "data": [
    {
      "id": "uuid",
      "title": "æ­Œæ›²æ ‡é¢˜",
      "artist": "è‰ºæœ¯å®¶",
      "album": "ä¸“è¾‘åç§°",
      "duration": 240,
      "coverUrl": "https://example.com/cover.jpg",
      "audioUrl": "https://example.com/audio.mp3",
      "genre": "æµè¡Œ",
      "year": 2024,
      "playCount": 1000,
      "createdAt": "2025-06-27T10:00:00.000Z"
    }
  ],
  "pagination": {
    "page": 1,
    "limit": 20,
    "total": 100,
    "totalPages": 5
  }
}
```

### è·å–æ­Œæ›²è¯¦æƒ…

**GET** `/songs/{id}`

æ ¹æ®IDè·å–æ­Œæ›²çš„è¯¦ç»†ä¿¡æ¯ã€‚

**è·¯å¾„å‚æ•°**:
- `id`: æ­Œæ›²UUID

**å“åº”**:
```json
{
  "success": true,
  "data": {
    "id": "uuid",
    "title": "æ­Œæ›²æ ‡é¢˜",
    "artist": "è‰ºæœ¯å®¶",
    "album": "ä¸“è¾‘åç§°",
    "duration": 240,
    "coverUrl": "https://example.com/cover.jpg",
    "audioUrl": "https://example.com/audio.mp3",
    "genre": "æµè¡Œ",
    "year": 2024,
    "playCount": 1000,
    "lyrics": "æ­Œè¯å†…å®¹...",
    "fileSize": 5242880,
    "originalFileName": "song.mp3",
    "createdAt": "2025-06-27T10:00:00.000Z",
    "updatedAt": "2025-06-27T10:00:00.000Z"
  }
}
```

### æœç´¢æ­Œæ›²

**GET** `/songs/search`

æœç´¢æ­Œæ›²ï¼Œæ”¯æŒæ ‡é¢˜ã€è‰ºæœ¯å®¶ã€ä¸“è¾‘æœç´¢ã€‚

**æŸ¥è¯¢å‚æ•°**:
- `q`: æœç´¢å…³é”®è¯ (å¿…éœ€)
- `page`: é¡µç  (é»˜è®¤: 1)
- `limit`: æ¯é¡µæ•°é‡ (é»˜è®¤: 20)

### è·å–çƒ­é—¨æ­Œæ›²

**GET** `/songs/popular`

è·å–çƒ­é—¨æ­Œæ›²åˆ—è¡¨ã€‚

**æŸ¥è¯¢å‚æ•°**:
- `limit`: è¿”å›æ•°é‡ (é»˜è®¤: 50)
- `period`: æ—¶é—´èŒƒå›´ (`day`, `week`, `month`, `all`)

### è·å–æœ€æ–°æ­Œæ›²

**GET** `/songs/latest`

è·å–æœ€æ–°ä¸Šä¼ çš„æ­Œæ›²ã€‚

**æŸ¥è¯¢å‚æ•°**:
- `limit`: è¿”å›æ•°é‡ (é»˜è®¤: 20)

### å¢åŠ æ’­æ”¾æ¬¡æ•°

**POST** `/songs/{id}/play`

ğŸ”’ **éœ€è¦è®¤è¯**

è®°å½•æ­Œæ›²æ’­æ”¾ï¼Œå¢åŠ æ’­æ”¾æ¬¡æ•°ã€‚

**è·¯å¾„å‚æ•°**:
- `id`: æ­Œæ›²UUID

---

## ğŸ“ æ­Œå•æ¨¡å— (Playlists)

### åˆ›å»ºæ­Œå•

**POST** `/playlists`

ğŸ”’ **éœ€è¦è®¤è¯**

åˆ›å»ºæ–°çš„æ­Œå•ã€‚

**è¯·æ±‚ä½“**:
```json
{
  "name": "æˆ‘çš„æ­Œå•",
  "description": "æ­Œå•æè¿°",
  "coverUrl": "https://example.com/cover.jpg",
  "isPrivate": false
}
```

### è·å–æ­Œå•åˆ—è¡¨

**GET** `/playlists`

è·å–æ­Œå•åˆ—è¡¨ï¼Œæ”¯æŒåˆ†é¡µå’Œç­›é€‰ã€‚

**æŸ¥è¯¢å‚æ•°**:
- `page`: é¡µç  (é»˜è®¤: 1)
- `limit`: æ¯é¡µæ•°é‡ (é»˜è®¤: 20)
- `userId`: ç”¨æˆ·IDç­›é€‰
- `isPrivate`: æ˜¯å¦ç§æœ‰

### è·å–ç”¨æˆ·æ­Œå•

**GET** `/playlists/user`

ğŸ”’ **éœ€è¦è®¤è¯**

è·å–å½“å‰ç”¨æˆ·çš„æ‰€æœ‰æ­Œå•ã€‚

### è·å–æ­Œå•è¯¦æƒ…

**GET** `/playlists/{id}`

æ ¹æ®IDè·å–æ­Œå•è¯¦æƒ…ï¼ŒåŒ…å«æ­Œæ›²åˆ—è¡¨ã€‚

**è·¯å¾„å‚æ•°**:
- `id`: æ­Œå•UUID

**å“åº”**:
```json
{
  "success": true,
  "data": {
    "id": "uuid",
    "name": "æˆ‘çš„æ­Œå•",
    "description": "æ­Œå•æè¿°",
    "coverUrl": "https://example.com/cover.jpg",
    "isPrivate": false,
    "isDefault": false,
    "createdAt": "2025-06-27T10:00:00.000Z",
    "user": {
      "id": "uuid",
      "username": "testuser",
      "avatar": "https://example.com/avatar.jpg"
    },
    "songs": [
      {
        "id": "uuid",
        "title": "æ­Œæ›²æ ‡é¢˜",
        "artist": "è‰ºæœ¯å®¶",
        "duration": 240,
        "coverUrl": "https://example.com/cover.jpg"
      }
    ],
    "songCount": 10
  }
}
```

### æ›´æ–°æ­Œå•

**PUT** `/playlists/{id}`

ğŸ”’ **éœ€è¦è®¤è¯**

æ›´æ–°æ­Œå•ä¿¡æ¯ã€‚

### åˆ é™¤æ­Œå•

**DELETE** `/playlists/{id}`

ğŸ”’ **éœ€è¦è®¤è¯**

åˆ é™¤æ­Œå•ã€‚

### æ·»åŠ æ­Œæ›²åˆ°æ­Œå•

**POST** `/playlists/{id}/songs`

ğŸ”’ **éœ€è¦è®¤è¯**

å‘æ­Œå•æ·»åŠ æ­Œæ›²ã€‚

**è¯·æ±‚ä½“**:
```json
{
  "songId": "uuid"
}
```

### ä»æ­Œå•ç§»é™¤æ­Œæ›²

**DELETE** `/playlists/{id}/songs/{songId}`

ğŸ”’ **éœ€è¦è®¤è¯**

ä»æ­Œå•ä¸­ç§»é™¤æŒ‡å®šæ­Œæ›²ã€‚

---

## â¤ï¸ æ”¶è—æ¨¡å— (Favorites)

### æ·»åŠ æ”¶è—

**POST** `/favorites`

ğŸ”’ **éœ€è¦è®¤è¯**

æ”¶è—æ­Œæ›²ã€‚

**è¯·æ±‚ä½“**:
```json
{
  "songId": "uuid"
}
```

### è·å–æ”¶è—åˆ—è¡¨

**GET** `/favorites`

ğŸ”’ **éœ€è¦è®¤è¯**

è·å–ç”¨æˆ·çš„æ”¶è—æ­Œæ›²åˆ—è¡¨ã€‚

**æŸ¥è¯¢å‚æ•°**:
- `page`: é¡µç  (é»˜è®¤: 1)
- `limit`: æ¯é¡µæ•°é‡ (é»˜è®¤: 20)

### å–æ¶ˆæ”¶è—

**DELETE** `/favorites/{songId}`

ğŸ”’ **éœ€è¦è®¤è¯**

å–æ¶ˆæ”¶è—æŒ‡å®šæ­Œæ›²ã€‚

### æ£€æŸ¥æ”¶è—çŠ¶æ€

**GET** `/favorites/check/{songId}`

ğŸ”’ **éœ€è¦è®¤è¯**

æ£€æŸ¥æ­Œæ›²æ˜¯å¦å·²æ”¶è—ã€‚

---

## ğŸ¨ éŸ³ä¹ç±»å‹æ¨¡å— (Genres)

### è·å–éŸ³ä¹ç±»å‹åˆ—è¡¨

**GET** `/genres`

è·å–æ‰€æœ‰éŸ³ä¹ç±»å‹ã€‚

**å“åº”**:
```json
{
  "success": true,
  "data": [
    {
      "id": "uuid",
      "name": "æµè¡Œ",
      "description": "æµè¡ŒéŸ³ä¹",
      "isActive": true,
      "songCount": 100,
      "createdAt": "2025-06-27T10:00:00.000Z"
    }
  ]
}
```

### è·å–ç±»å‹è¯¦æƒ…

**GET** `/genres/{id}`

æ ¹æ®IDè·å–éŸ³ä¹ç±»å‹è¯¦æƒ…ã€‚

### è·å–ç±»å‹ä¸‹çš„æ­Œæ›²

**GET** `/genres/{id}/songs`

è·å–æŒ‡å®šç±»å‹ä¸‹çš„æ­Œæ›²åˆ—è¡¨ã€‚

---

## ğŸ“¤ æ–‡ä»¶ä¸Šä¼ æ¨¡å— (Upload)

### ä¸Šä¼ éŸ³é¢‘æ–‡ä»¶

**POST** `/upload/audio`

ğŸ”’ **éœ€è¦è®¤è¯**

ä¸Šä¼ éŸ³é¢‘æ–‡ä»¶ã€‚

**è¯·æ±‚**: `multipart/form-data`
- `file`: éŸ³é¢‘æ–‡ä»¶ (å¿…éœ€)
- `title`: æ­Œæ›²æ ‡é¢˜
- `artist`: è‰ºæœ¯å®¶
- `album`: ä¸“è¾‘

**å“åº”**:
```json
{
  "success": true,
  "data": {
    "id": "uuid",
    "title": "æ­Œæ›²æ ‡é¢˜",
    "artist": "è‰ºæœ¯å®¶",
    "audioUrl": "https://example.com/uploads/audio.mp3",
    "coverUrl": "https://example.com/uploads/cover.jpg",
    "duration": 240,
    "fileSize": 5242880
  }
}
```

### ä¸Šä¼ å›¾ç‰‡

**POST** `/upload/image`

ğŸ”’ **éœ€è¦è®¤è¯**

ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶ï¼ˆå¤´åƒã€å°é¢ç­‰ï¼‰ã€‚

**è¯·æ±‚**: `multipart/form-data`
- `file`: å›¾ç‰‡æ–‡ä»¶ (å¿…éœ€)
- `type`: å›¾ç‰‡ç±»å‹ (`avatar`, `cover`, `other`)

---

## ğŸ’¬ è¯„è®ºæ¨¡å— (Comments)

### æ·»åŠ è¯„è®º

**POST** `/comments`

ğŸ”’ **éœ€è¦è®¤è¯**

ä¸ºæ­Œæ›²æ·»åŠ è¯„è®ºã€‚

**è¯·æ±‚ä½“**:
```json
{
  "songId": "uuid",
  "content": "è¯„è®ºå†…å®¹",
  "parentId": "uuid" // å¯é€‰ï¼Œå›å¤è¯„è®ºæ—¶ä½¿ç”¨
}
```

### è·å–è¯„è®ºåˆ—è¡¨

**GET** `/comments`

è·å–è¯„è®ºåˆ—è¡¨ã€‚

**æŸ¥è¯¢å‚æ•°**:
- `songId`: æ­Œæ›²ID (å¿…éœ€)
- `page`: é¡µç  (é»˜è®¤: 1)
- `limit`: æ¯é¡µæ•°é‡ (é»˜è®¤: 20)
- `sort`: æ’åºæ–¹å¼ (`latest`, `oldest`, `popular`)

### åˆ é™¤è¯„è®º

**DELETE** `/comments/{id}`

ğŸ”’ **éœ€è¦è®¤è¯**

åˆ é™¤è¯„è®ºï¼ˆä»…è¯„è®ºä½œè€…å¯åˆ é™¤ï¼‰ã€‚

---

## ğŸ“Š æ’­æ”¾å†å²æ¨¡å— (History)

### æ·»åŠ æ’­æ”¾è®°å½•

**POST** `/history`

ğŸ”’ **éœ€è¦è®¤è¯**

è®°å½•æ­Œæ›²æ’­æ”¾å†å²ã€‚

**è¯·æ±‚ä½“**:
```json
{
  "songId": "uuid",
  "playDuration": 180 // æ’­æ”¾æ—¶é•¿ï¼ˆç§’ï¼‰
}
```

### è·å–æ’­æ”¾å†å²

**GET** `/history`

ğŸ”’ **éœ€è¦è®¤è¯**

è·å–ç”¨æˆ·æ’­æ”¾å†å²ã€‚

**æŸ¥è¯¢å‚æ•°**:
- `page`: é¡µç  (é»˜è®¤: 1)
- `limit`: æ¯é¡µæ•°é‡ (é»˜è®¤: 20)
- `startDate`: å¼€å§‹æ—¥æœŸ
- `endDate`: ç»“æŸæ—¥æœŸ

### æ¸…ç©ºæ’­æ”¾å†å²

**DELETE** `/history`

ğŸ”’ **éœ€è¦è®¤è¯**

æ¸…ç©ºç”¨æˆ·çš„æ’­æ”¾å†å²è®°å½•ã€‚

---

## ğŸ” æœç´¢å†å²æ¨¡å— (Search History)

### æ·»åŠ æœç´¢è®°å½•

**POST** `/search-history`

ğŸ”’ **éœ€è¦è®¤è¯**

è®°å½•ç”¨æˆ·æœç´¢å†å²ã€‚

**è¯·æ±‚ä½“**:
```json
{
  "query": "æœç´¢å…³é”®è¯",
  "resultCount": 10
}
```

### è·å–æœç´¢å†å²

**GET** `/search-history`

ğŸ”’ **éœ€è¦è®¤è¯**

è·å–ç”¨æˆ·æœç´¢å†å²ã€‚

### æ¸…ç©ºæœç´¢å†å²

**DELETE** `/search-history`

ğŸ”’ **éœ€è¦è®¤è¯**

æ¸…ç©ºç”¨æˆ·çš„æœç´¢å†å²è®°å½•ã€‚

---

## âš™ï¸ ç”¨æˆ·åå¥½æ¨¡å— (User Preferences)

### è·å–ç”¨æˆ·åå¥½

**GET** `/user-preferences`

ğŸ”’ **éœ€è¦è®¤è¯**

è·å–ç”¨æˆ·åå¥½è®¾ç½®ã€‚

**å“åº”**:
```json
{
  "success": true,
  "data": {
    "id": "uuid",
    "userId": "uuid",
    "theme": "dark",
    "language": "zh-CN",
    "autoPlay": true,
    "playQuality": "high",
    "downloadQuality": "lossless",
    "notifications": {
      "newFollower": true,
      "newComment": true,
      "systemUpdate": false
    }
  }
}
```

### æ›´æ–°ç”¨æˆ·åå¥½

**PUT** `/user-preferences`

ğŸ”’ **éœ€è¦è®¤è¯**

æ›´æ–°ç”¨æˆ·åå¥½è®¾ç½®ã€‚

---

## ğŸ‘¥ ç¤¾äº¤åŠŸèƒ½æ¨¡å— (Social)

### å…³æ³¨ç”¨æˆ·

**POST** `/social/follow`

ğŸ”’ **éœ€è¦è®¤è¯**

å…³æ³¨å…¶ä»–ç”¨æˆ·ã€‚

**è¯·æ±‚ä½“**:
```json
{
  "userId": "uuid"
}
```

### å–æ¶ˆå…³æ³¨

**DELETE** `/social/follow/{userId}`

ğŸ”’ **éœ€è¦è®¤è¯**

å–æ¶ˆå…³æ³¨ç”¨æˆ·ã€‚

### è·å–å…³æ³¨åˆ—è¡¨

**GET** `/social/following`

ğŸ”’ **éœ€è¦è®¤è¯**

è·å–ç”¨æˆ·å…³æ³¨çš„äººåˆ—è¡¨ã€‚

### è·å–ç²‰ä¸åˆ—è¡¨

**GET** `/social/followers`

ğŸ”’ **éœ€è¦è®¤è¯**

è·å–ç”¨æˆ·çš„ç²‰ä¸åˆ—è¡¨ã€‚

### å‘å¸ƒåŠ¨æ€

**POST** `/social/feeds`

ğŸ”’ **éœ€è¦è®¤è¯**

å‘å¸ƒç”¨æˆ·åŠ¨æ€ã€‚

**è¯·æ±‚ä½“**:
```json
{
  "content": "åŠ¨æ€å†…å®¹",
  "type": "text", // "text" | "music" | "playlist"
  "relatedId": "uuid" // ç›¸å…³æ­Œæ›²æˆ–æ­Œå•ID
}
```

### è·å–åŠ¨æ€åˆ—è¡¨

**GET** `/social/feeds`

ğŸ”’ **éœ€è¦è®¤è¯**

è·å–å…³æ³¨ç”¨æˆ·çš„åŠ¨æ€åˆ—è¡¨ã€‚

### ç‚¹èµåŠ¨æ€

**POST** `/social/feeds/{id}/like`

ğŸ”’ **éœ€è¦è®¤è¯**

ä¸ºåŠ¨æ€ç‚¹èµã€‚

### è¯„è®ºåŠ¨æ€

**POST** `/social/feeds/{id}/comments`

ğŸ”’ **éœ€è¦è®¤è¯**

è¯„è®ºåŠ¨æ€ã€‚

---

## ğŸ“¥ ä¸‹è½½æ¨¡å— (Download)

### åˆ›å»ºä¸‹è½½ä»»åŠ¡

**POST** `/download`

ğŸ”’ **éœ€è¦è®¤è¯**

åˆ›å»ºéŸ³ä¹ä¸‹è½½ä»»åŠ¡ã€‚

**è¯·æ±‚ä½“**:
```json
{
  "songId": "uuid",
  "quality": "high" // "low" | "medium" | "high" | "lossless"
}
```

### è·å–ä¸‹è½½åˆ—è¡¨

**GET** `/download`

ğŸ”’ **éœ€è¦è®¤è¯**

è·å–ç”¨æˆ·çš„ä¸‹è½½ä»»åŠ¡åˆ—è¡¨ã€‚

### è·å–å­˜å‚¨ä¿¡æ¯

**GET** `/download/storage`

ğŸ”’ **éœ€è¦è®¤è¯**

è·å–ç”¨æˆ·å­˜å‚¨ç©ºé—´ä¿¡æ¯ã€‚

**å“åº”**:
```json
{
  "success": true,
  "data": {
    "totalSpace": 1073741824, // 1GB
    "usedSpace": 536870912,   // 512MB
    "availableSpace": 536870912,
    "usagePercentage": 50.0,
    "downloadCount": 25
  }
}
```

### åˆ é™¤ä¸‹è½½

**DELETE** `/download/{id}`

ğŸ”’ **éœ€è¦è®¤è¯**

åˆ é™¤ä¸‹è½½çš„éŸ³ä¹æ–‡ä»¶ã€‚

---

## ğŸ”§ ç³»ç»Ÿæ¥å£

### å¥åº·æ£€æŸ¥

**GET** `/health`

æ£€æŸ¥æœåŠ¡å¥åº·çŠ¶æ€ã€‚

**å“åº”**:
```json
{
  "status": "ok",
  "timestamp": "2025-06-27T10:00:00.000Z",
  "uptime": 3600,
  "environment": "development",
  "version": "1.0.0"
}
```

### è·å–CSRFä»¤ç‰Œ

**GET** `/csrf-token`

è·å–CSRFé˜²æŠ¤ä»¤ç‰Œã€‚

**å“åº”**:
```json
{
  "csrfToken": "csrf-token-string"
}
```

---

## ğŸ“ çŠ¶æ€ç è¯´æ˜

| çŠ¶æ€ç  | è¯´æ˜ |
|--------|------|
| 200 | è¯·æ±‚æˆåŠŸ |
| 201 | åˆ›å»ºæˆåŠŸ |
| 400 | è¯·æ±‚å‚æ•°é”™è¯¯ |
| 401 | æœªæˆæƒï¼Œéœ€è¦ç™»å½• |
| 403 | ç¦æ­¢è®¿é—®ï¼Œæƒé™ä¸è¶³ |
| 404 | èµ„æºä¸å­˜åœ¨ |
| 409 | èµ„æºå†²çª |
| 422 | è¯·æ±‚å‚æ•°éªŒè¯å¤±è´¥ |
| 429 | è¯·æ±‚è¿‡äºé¢‘ç¹ |
| 500 | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ |

---

## ğŸ”„ å®æ—¶é€šä¿¡ (WebSocket)

### è¿æ¥åœ°å€

```
ws://localhost:3000/socket.io/
```

### è®¤è¯

è¿æ¥æ—¶éœ€è¦æä¾›JWTä»¤ç‰Œï¼š

```javascript
const socket = io('http://localhost:3000', {
  auth: {
    token: 'your-jwt-token'
  }
});
```

### äº‹ä»¶åˆ—è¡¨

#### å®¢æˆ·ç«¯å‘é€äº‹ä»¶

- `join-room`: åŠ å…¥æˆ¿é—´
- `leave-room`: ç¦»å¼€æˆ¿é—´
- `send-message`: å‘é€æ¶ˆæ¯

#### æœåŠ¡ç«¯æ¨é€äº‹ä»¶

- `notification`: ç³»ç»Ÿé€šçŸ¥
- `new-follower`: æ–°ç²‰ä¸é€šçŸ¥
- `new-comment`: æ–°è¯„è®ºé€šçŸ¥
- `user-online`: ç”¨æˆ·ä¸Šçº¿
- `user-offline`: ç”¨æˆ·ä¸‹çº¿

---

*æœ¬æ–‡æ¡£æŒç»­æ›´æ–°ä¸­ï¼Œå¦‚æœ‰ç–‘é—®è¯·å‚è€ƒSwaggeråœ¨çº¿æ–‡æ¡£æˆ–è”ç³»å¼€å‘å›¢é˜Ÿã€‚*
